//// Copyright (c) Intersil-Techwell
//// Gamma Data for TW8835, Apr  1 2013

//// RGB Gamma Text File

const uint8_t GammaRed[]=
{
    0x00,0x00,0x01,0x01,0x01,0x02,0x02,0x02,0x03,0x03,0x03,0x04,0x04,0x04,0x05,0x05,
    0x06,0x06,0x07,0x07,0x08,0x08,0x08,0x09,0x0A,0x0A,0x0B,0x0B,0x0C,0x0C,0x0D,0x0D,
    0x0E,0x0F,0x0F,0x10,0x10,0x11,0x12,0x12,0x13,0x14,0x14,0x15,0x16,0x16,0x17,0x18,
    0x19,0x19,0x1A,0x1B,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x20,0x21,0x22,0x23,0x24,0x25,
    0x26,0x27,0x28,0x29,0x2A,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x33,0x34,0x35,
    0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x40,0x41,0x42,0x43,0x45,0x46,0x47,
    0x48,0x49,0x4B,0x4C,0x4D,0x4E,0x50,0x51,0x52,0x54,0x55,0x56,0x58,0x59,0x5A,0x5C,
    0x5D,0x5F,0x60,0x61,0x63,0x64,0x66,0x67,0x69,0x6A,0x6C,0x6D,0x6F,0x70,0x72,0x74,
    0x76,0x77,0x79,0x7B,0x7D,0x7F,0x81,0x83,0x84,0x86,0x87,0x89,0x8B,0x8D,0x8F,0x90,
    0x92,0x93,0x95,0x96,0x98,0x9A,0x9C,0x9D,0x9F,0xA0,0xA2,0xA3,0xA5,0xA6,0xA7,0xA9,
    0xAA,0xAC,0xAD,0xAF,0xB0,0xB2,0xB3,0xB4,0xB6,0xB7,0xB8,0xBA,0xBB,0xBC,0xBD,0xBF,
    0xC0,0xC1,0xC2,0xC3,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCD,0xCE,0xCF,0xD0,0xD1,
    0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDB,0xDC,0xDD,0xDE,0xDF,0xE0,
    0xE1,0xE2,0xE3,0xE3,0xE4,0xE5,0xE6,0xE7,0xE7,0xE8,0xE9,0xEA,0xEA,0xEB,0xEC,0xED,
    0xED,0xEE,0xEF,0xEF,0xF0,0xF1,0xF1,0xF2,0xF2,0xF3,0xF4,0xF4,0xF5,0xF5,0xF6,0xF6,
    0xF7,0xF8,0xF8,0xF9,0xF9,0xFA,0xFB,0xFB,0xFB,0xFC,0xFD,0xFD,0xFD,0xFE,0xFF,0xFF,
};

const uint8_t GammaGreen[]=
{
    0x00,0x00,0x01,0x01,0x01,0x02,0x02,0x02,0x03,0x03,0x03,0x04,0x04,0x04,0x05,0x05,
    0x06,0x06,0x07,0x07,0x08,0x08,0x08,0x09,0x0A,0x0A,0x0B,0x0B,0x0C,0x0C,0x0D,0x0D,
    0x0E,0x0F,0x0F,0x10,0x10,0x11,0x12,0x12,0x13,0x14,0x14,0x15,0x16,0x16,0x17,0x18,
    0x19,0x19,0x1A,0x1B,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x20,0x21,0x22,0x23,0x24,0x25,
    0x26,0x27,0x28,0x29,0x2A,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x33,0x34,0x35,
    0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x40,0x41,0x42,0x43,0x45,0x46,0x47,
    0x48,0x49,0x4B,0x4C,0x4D,0x4E,0x50,0x51,0x52,0x54,0x55,0x56,0x58,0x59,0x5A,0x5C,
    0x5D,0x5F,0x60,0x61,0x63,0x64,0x66,0x67,0x69,0x6A,0x6C,0x6D,0x6F,0x70,0x72,0x74,
    0x76,0x77,0x79,0x7B,0x7D,0x7F,0x81,0x83,0x84,0x86,0x87,0x89,0x8B,0x8D,0x8F,0x90,
    0x92,0x93,0x95,0x96,0x98,0x9A,0x9C,0x9D,0x9F,0xA0,0xA2,0xA3,0xA5,0xA6,0xA7,0xA9,
    0xAA,0xAC,0xAD,0xAF,0xB0,0xB2,0xB3,0xB4,0xB6,0xB7,0xB8,0xBA,0xBB,0xBC,0xBD,0xBF,
    0xC0,0xC1,0xC2,0xC3,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCD,0xCE,0xCF,0xD0,0xD1,
    0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDB,0xDC,0xDD,0xDE,0xDF,0xE0,
    0xE1,0xE2,0xE3,0xE3,0xE4,0xE5,0xE6,0xE7,0xE7,0xE8,0xE9,0xEA,0xEA,0xEB,0xEC,0xED,
    0xED,0xEE,0xEF,0xEF,0xF0,0xF1,0xF1,0xF2,0xF2,0xF3,0xF4,0xF4,0xF5,0xF5,0xF6,0xF6,
    0xF7,0xF8,0xF8,0xF9,0xF9,0xFA,0xFB,0xFB,0xFB,0xFC,0xFD,0xFD,0xFD,0xFE,0xFF,0xFF,
};

const uint8_t GammaBlue[]=
{
    0x00,0x00,0x01,0x01,0x01,0x02,0x02,0x02,0x03,0x03,0x03,0x04,0x04,0x04,0x05,0x05,
    0x06,0x06,0x07,0x07,0x08,0x08,0x08,0x09,0x0A,0x0A,0x0B,0x0B,0x0C,0x0C,0x0D,0x0D,
    0x0E,0x0F,0x0F,0x10,0x10,0x11,0x12,0x12,0x13,0x14,0x14,0x15,0x16,0x16,0x17,0x18,
    0x19,0x19,0x1A,0x1B,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x20,0x21,0x22,0x23,0x24,0x25,
    0x26,0x27,0x28,0x29,0x2A,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x33,0x34,0x35,
    0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x40,0x41,0x42,0x43,0x45,0x46,0x47,
    0x48,0x49,0x4B,0x4C,0x4D,0x4E,0x50,0x51,0x52,0x54,0x55,0x56,0x58,0x59,0x5A,0x5C,
    0x5D,0x5F,0x60,0x61,0x63,0x64,0x66,0x67,0x69,0x6A,0x6C,0x6D,0x6F,0x70,0x72,0x74,
    0x76,0x77,0x79,0x7B,0x7D,0x7F,0x81,0x83,0x84,0x86,0x87,0x89,0x8B,0x8D,0x8F,0x90,
    0x92,0x93,0x95,0x96,0x98,0x9A,0x9C,0x9D,0x9F,0xA0,0xA2,0xA3,0xA5,0xA6,0xA7,0xA9,
    0xAA,0xAC,0xAD,0xAF,0xB0,0xB2,0xB3,0xB4,0xB6,0xB7,0xB8,0xBA,0xBB,0xBC,0xBD,0xBF,
    0xC0,0xC1,0xC2,0xC3,0xC5,0xC6,0xC7,0xC8,0xC9,0xCA,0xCB,0xCD,0xCE,0xCF,0xD0,0xD1,
    0xD2,0xD3,0xD4,0xD5,0xD6,0xD7,0xD8,0xD9,0xDA,0xDB,0xDB,0xDC,0xDD,0xDE,0xDF,0xE0,
    0xE1,0xE2,0xE3,0xE3,0xE4,0xE5,0xE6,0xE7,0xE7,0xE8,0xE9,0xEA,0xEA,0xEB,0xEC,0xED,
    0xED,0xEE,0xEF,0xEF,0xF0,0xF1,0xF1,0xF2,0xF2,0xF3,0xF4,0xF4,0xF5,0xF5,0xF6,0xF6,
    0xF7,0xF8,0xF8,0xF9,0xF9,0xFA,0xFB,0xFB,0xFB,0xFC,0xFD,0xFD,0xFD,0xFE,0xFF,0xFF,
};


uint8_t Tw8836_OpenGamma(uint8_t flag)
{
    uint8_t Result = SUBLAYER_DOING;
    TW8836_WritePage( PAGE2_GAMMA );  //Switch to page 2
    if(flag)
        Result = TW8836_WriteData(PAGE2_GAMMA|0xe0, 0xe4 );
    else
        Result = TW8836_WriteData(PAGE2_GAMMA|0xe0, 0x00 );

    return Result;
}


uint8_t Tw8836_DownLoadGamma(void)
{
    uint8_t Result = SUBLAYER_DOING;
    uint8_t SubResult = SUBLAYER_DOING;
    uint8_t TimeOut=0;

    switch(fTw8836.DrvSubStep)
    {
        case OPERATION_0:
            video_printf(_T("Gamma:%d \n",fTw8836.DrvSubStep));
            SubResult =TW8836_WritePage( PAGE2_GAMMA );  //Switch to page 2
            // Red
            SubResult &= TW8836_WriteData(PAGE2_GAMMA|0xe0, 0xe8|1 );
            SubResult &= TW8836_WriteData(PAGE2_GAMMA|0xe1, 0x00); //  Start Address
            if(SUBLAYER_DONE == SubResult)
            {
                video_printf(_T("--1.Gamma-- \n"));
                fTw8836.DrvSubStep = OPERATION_1;
            }
            break;
        case OPERATION_1:
        {
            while(1)
            {
                CLEAR_WATCHDOG();
                SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe3, GammaRed[fTw8836.GammaCount]);
                if(SUBLAYER_DONE == SubResult)
                {
                    TimeOut = 0;
                    fTw8836.GammaCount++;
                    if(0x00 == fTw8836.GammaCount)
                    {
                        fTw8836.DrvSubStep = OPERATION_2;
                        video_printf(_T("--2.Gamma:0x%x-- \n",fTw8836.GammaCount));
                        break;
                    }
                }
                else
                {
                    if(TimeOut>100)
                    break;
                    TimeOut++;
                }
                if(l_tPwrCB.uIOFlag.field.bLvi)
                  break;
            }
        }
        break;
        case OPERATION_2:
            // Green
            SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe0, 0xe8|2 );
            SubResult &= TW8836_WriteData(PAGE2_GAMMA|0xe1, 0x00); //  Start Address
            if(SUBLAYER_DONE == SubResult)
            {
                fTw8836.DrvSubStep = OPERATION_3;
            }
            break;
        case OPERATION_3:
        {
            while(1)
            {
                CLEAR_WATCHDOG();
                SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe3, GammaRed[fTw8836.GammaCount]);
                if(SUBLAYER_DONE == SubResult)
                {
                    fTw8836.GammaCount++;
                    TimeOut = 0;
                    if(0x00 == fTw8836.GammaCount)
                    {
                        fTw8836.DrvSubStep = OPERATION_4;
                        video_printf(_T("--3.Gamma:0x%x-- \n",fTw8836.GammaCount));
                        break;
                    }
                }
                else
                {
                    if(TimeOut>100)
                    break;
                    TimeOut++;
                }
                if(l_tPwrCB.uIOFlag.field.bLvi)
                  break;
            }
        }
        break;
        case OPERATION_4:
            // Blue
            SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe0, 0xe8|3 );
            SubResult &= TW8836_WriteData(PAGE2_GAMMA|0xe1, 0x00); //  Start Address
            if(SUBLAYER_DONE == SubResult)
            {
                fTw8836.DrvSubStep = OPERATION_5;
            }
            break;
#ifdef TW8836_ALL_SRC_OPEN_GAMMA
        case OPERATION_5:
        {
            while(1)
            {
                CLEAR_WATCHDOG();
                SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe3, GammaRed[fTw8836.GammaCount]);
                if(SUBLAYER_DONE == SubResult)
                {
                    fTw8836.GammaCount++;
                    TimeOut = 0;
                    if(0x00 == fTw8836.GammaCount)
                    {
                        fTw8836.DrvSubStep = OPERATION_6;
                        video_printf(_T("--4.Gamma:0x%x-- \n",fTw8836.GammaCount));
                        break;
                    }
                }
                else
                {
                    if(TimeOut>100)
                    break;
                    TimeOut++;
                }
                if(l_tPwrCB.uIOFlag.field.bLvi)
                  break;
            }
        }
        break;
        case OPERATION_6:
            SubResult = Tw8836_OpenGamma(ON);
            if(SUBLAYER_DONE == SubResult)
            {
                fTw8836.DrvSubStep = OPERATION_0;
                Result = SUBLAYER_DONE;
                video_printf(_T("--Gamma end-- \n"));
            }
            break;
#else
        case OPERATION_5:
            SubResult = TW8836_WriteData(PAGE2_GAMMA|0xe3, GammaRed[fTw8836.GammaCount]);
            if(SUBLAYER_DONE == SubResult)
            {
                if(0xff == fTw8836.GammaCount)
                {
                    fTw8836.DrvSubStep = OPERATION_0;
                    Result = SUBLAYER_DONE;
                    video_printf(_T("--Gamma end-- \n"));
                }
                fTw8836.GammaCount++;
            }
            break;
#endif
        default:
            break;
    }

    return Result;
}


